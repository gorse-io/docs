---
icon: flow-fill
---
# 流程编辑

Gorse控制台提供了可视化编辑推荐设置的界面，配置文件中的推荐设置会被可视化展示，编辑完成并保存之后，Gorse将优先加载流程编辑器定义的推荐流程。

![](../../../img/dashboard/recflow.png)

## 节点和连接

- **数据源**是推荐工作流的起始节点，不可删除和添加，可以向外连接到无数个推荐算法节点。双击节点可以编辑`[recommend.data_source]`配置。
- **推荐算法**接受来自数据源的连接，可以连接到排序节点、备用节点和推荐节点，节点有六种类型：
  - **最新**物品，不可删除不可编辑；
  - **非个性化**推荐推荐节点可以有多个，对应配置文件中的`[[recommend.non-personalized]]`
  - **外部 API**推荐算法推荐节点可以有多个，对应配置文件中的`[[recommend.external]]`
  - **物品到物品**推荐算法推荐节点可以有多个，对应配置文件中的`[[recommend.item-to-item]]`
  - **协同过滤**节点至多只能有一个，对应配置文件中的`[recommend.collaborative]`
  - **用户到用户**推荐节点可以有多个，对应配置文件中的`[[recommend.user-to-user]]`
- **排序**节点至多只能有一个，对应配置文件中的`[recommend.ranker]`
- **备用**节点至多只能有一个，对应配置文件中的`[recommend.fallback]`
- **推荐**是工作流的结束节点，不可删除和添加，双击节点可以编辑`[recommend]`配置。只接受三种节点的连接：
  - 排序：一般情况下，推荐给用户的物品来自排序节点。
  - 推荐算法：当不使用排序时，可以直接从推荐算法获取推荐结果，但是只能有一个推荐算法节点连接到推荐节点。
  - 备用：当排序节点或者推荐算法节点没有推荐结果时，使用备用节点的推荐结果。

## 节点编辑预览

除了编辑节点和连接，编辑器还提供了部分类型节点的预览。

### 外部API预览

双击外部API节点，即可看到外部API推荐的预览界面。

![=600x](../../../img/dashboard/api.png)

输入用户ID后点击运行按钮，预览功能将调用外部API获取推荐结果并展示。

### 大语言模型排序预览

双击排序节点，选择类型为LLM，即可看到大语言模型排序的预览界面。

![=600x](../../../img/dashboard/llm.png)

输入用户ID后点击运行按钮，预览功能将读取用户最近的反馈和最新物品，使用提示词模板渲染提示词。将渲染好的提示词发送给大预言模型，依据最近反馈对最新物品进行排序，并展示大语言模型的排序结果。

::: tip
大语言模型排序预览主要用于检查模型输出结果的格式是否符合预期，如果返回格式不正确或者丢失的排序内容较多，排序效果也就无从谈起。
:::

## 保存和重置

在编辑推荐流程后，点击右上角的“保存”按钮即可保存当前的推荐流程配置。点击“重置”按钮可以将推荐流程恢复到配置文件中定义的固化推荐流程。如果后续没有编辑推荐流程的需求，建议将流程定义到[配置文件](../config.md#recommend)中。
